<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <title>Alimi <3</title>
</head>
<body>
    <div id="overlay" onclick="closeOverlay()"></div>

    <header>
        <h1 id="Tieu_De">Tổng hợp các bộ anime hay để xem cùng gia đình trong bữa cơm (hoặc là không)</h1>
    </header>
    
    <p id='debug' style="color: white; font-size: 30px;"></p>

    <div id="iframeContainer">          
        <video src="" type="video/mp4" id="video" controls> </video>
    </div>

    <div id="Contents">
        <p id = "debug"></p>

        <input type="text" id="inp" onkeyup="findAnime()" placeholder="Tìm kiếm anime...">

        <button id="button" onclick="advance()">
            <i class='fa fa-gear'></i>
        </button>

        <br><br>

        <div id="advanceSearchContainer">
            <button id="closeTab" onclick="closeTab()">X</button>
            <fieldset id="advanceTab">
                <legend>Thể loại</legend>
                <form id="advanceSearch" onsubmit="return false">

                <div class="searchItems">
                    <label>
                        <input type="checkbox" name="genre" id="action" value="1">
                        Action
                    </label>
                </div>
                
                <div class="searchItems">
                    <label>
                        <input type="checkbox" name="genre" id="adventure" value="2">
                        Adventure
                    </label>    
                </div>
                <div class="searchItems">
                    <label>
                        <input type="checkbox" name="genre" id="drama" value="3">
                        Drama
                    </label>
                </div>
                <div class="searchItems">
                    <label>
                        <input type="checkbox" name="genre" id="fantasy" value="4">
                        Fantasy
                    </label>
                </div>
                <div class="searchItems">
                    <label>
                        <input type="checkbox" name="genre" id="horror" value="5">
                        Horror
                    </label>
                </div>
                <div class="searchItems">
                    <label>
                        <input type="checkbox" name="genre" id="romance" value="6">
                        Romance
                    </label>
                </div>
                <div class="searchItems">
                    <label>
                        <input type="checkbox" name="genre" id="sci-fi" value="7"> 
                        Sci-fi
                    </label>
                </div>
                <div class="searchItems">
                    <label>
                        <input type="checkbox" name="genre" id="supernatural" value="8">
                        Supernatural
                    </label>
                </div>
                <div class="searchItems">
                    <label>
                        <input type="checkbox" name="genre" id="suspense" value="9">
                        Suspense
                    </label>
                </div>
                <br> <br>
                <div id="submitContainer">
                    <input type="button" name="submit" id="submitSearch" value="Xác nhận" onclick="submitForm()">
                </div> 
                </form>
            </fieldset>
        </div>

        <table id="lists" style="width:1000px">
            <tr>    
                <th style="width:10%">Rank</th>
                <th style="width:70%">Tên</th>
                <th style="width:20%">Studio</th>
            </tr>

            <tr>
                <td class="rank">1</td>

                <!-- ANIME -->
                <td class="item">
                    <a href="https://animevietsub.pub/phim/sousou-no-frieren-i2-a5073/" target="_blank">
                        <img class="image" src="images/anims/sousou_no_frieren.jpg">
                    </a>
                    <div class="descriptions">
                        <div class="detail">
                            <a class="anime_links" href="https://animevietsub.pub/phim/sousou-no-frieren-i2-a5073/" target="_blank">
                                <h3>Sousou no Frieren: Beyond's Journey End</h3>
                            </a>
                            <p>- TV series (28 episodes)                </p>
                            <p>- Rating: 9.33                           </p>
                            <p>- Thể loại: Fantasy, Adventure, Drama    </p>
                        </div>
                    </div>
                    <button class="trailerButton" value="videos/sousou_no_frieren.mp4"> Preview </button>
                </td>

                <!-- STUDIO -->
                <td class="studio">
                    <a class="studio_links" href="https://vi.wikipedia.org/wiki/Madhouse">
                        <img class="studio_image" src="images/studios/Madhouse.jpg">
                    </a>
                </td>
            </tr>

            <tr>
                <td class="rank">2</td>

                <!-- ANIME -->
                <td class="item">
                    <a class="anime_links" href="https://animevietsub.pub/phim/steins-gate-i4-a630/" target="_blank">
                        <img class="image" src="images/anims/stein_gate.jpg">
                    </a>
                    <div class="descriptions">
                        <div class="detail">
                            <a class="anime_links" href="https://animevietsub.pub/phim/steins-gate-i4-a630/" target="_blank">
                                <h3>Stein;Gate</h3>
                            </a>
                            <p>- TV series (24 episodes)                </p>
                            <p>- Rating: 9.07                           </p>
                            <p>- Thể loại: Drama, Sci-Fi, Suspense      </p>
                        </div>
                    </div>
                    <button class="trailerButton" value="videos/steins_gate.mp4"> Preview </button>
                </td>

                <!-- STUDIO -->
                <td class="studio">
                    <a class="studio_links" href="https://vi.wikipedia.org/wiki/White_Fox">
                        <img class="studio_image" src="images/studios/WhiteFox.jpg">
                    </a>
                </td>
            </tr>
            
            <tr>
                <td class="rank">3</td>

                <!-- ANIME -->
                <td class="item">
                    <a class="anime_links" href="https://animevietsub.pub/phim/dai-chien-titan-i2-a20/" target="_blank">
                        <img class="image" src="images/anims/attack_on_titan.jpg">
                    </a>
                    <div class="descriptions">
                        <div class="detail">
                            <a class="anime_links" href="https://animevietsub.pub/phim/dai-chien-titan-i2-a20/" target="_blank">
                                <h3>Shingeki no Kyojin Series</h3>
                            </a>
                            <p>- TV series (94 episodes)                </p>
                            <p>- Rating: 9.05                           </p>
                            <p>- Thể loại: Action, Fantasy, Horror      </p>
                        </div>
                    </div>
                    <button class="trailerButton" value="videos/attack_on_titan.mp4"> Preview </button>
                </td>

                <!-- STUDIO -->
                <td class="studio">
                    <a class="studio_links" href="https://vi.wikipedia.org/wiki/Wit_Studio">
                        <img class="studio_image" src="images/studios/Wit.jpg">
                    </a>

                    <a class="studio_links" href="https://vi.wikipedia.org/wiki/MAPPA">
                        <img class="studio_image" src="images/studios/mappa.jpg">
                    </a>
                </td>
            </tr>

            <tr>
                <td class="rank">4</td>

                <!-- ANIME -->
                <td class="item">
                    <a class="anime_links" href="https://animevietsub.pub/phim/violet-evergarden-a2882/" target="_blank">
                        <img class="image" src="images/anims/violet_evergarden.jpg">
                    </a>
                    <div class="descriptions">
                        <div class="detail">
                            <a class="anime_links" href="https://animevietsub.pub/phim/violet-evergarden-a2882/" target="_blank">
                                <h3>Violet Evergarden: Auto Memories Doll</h3>
                            </a>
                            <p>- TV series (13 episodes)                </p>
                            <p>- Rating: 8.68                           </p>
                            <p>- Thể loại: Drama, Fantasy, Romance      </p>
                        </div>
                    </div>
                    <button class="trailerButton" value="videos/violet_evergarden.mp4"> Preview </button>
                </td>

                <!-- STUDIO -->
                <td class="studio">
                    <a class="studio_links" href="https://vi.wikipedia.org/wiki/Ky%C5%8Dto_Animation">
                        <img class="studio_image" src="images/studios/KyotoAnimation.jpg">
                    </a>
                </td>
            </tr>
            
            <tr>
                <td class="rank">5</td>

                <!-- ANIME -->
                <td class="item">
                    <a class="anime_links" href="https://animevietsub.pub/phim/fatestay-night-movie-heavens-feel-i-presage-flower-i1-a4200/" target="_blank">
                        <img class="image" src="images/anims/heaven_feel.jpg">
                    </a>
                    <div class="descriptions">
                        <div class="detail">
                            <a class="anime_links" href="https://animevietsub.pub/phim/fatestay-night-movie-heavens-feel-i-presage-flower-i1-a4200/" target="_blank">
                                <h3>Fate/stay night Movies: Heaven's Feel </h3>
                            </a>
                            <p>- Movies (the third route)               </p>
                            <p>- Rating: 8.65                           </p>
                            <p>- Thể loại: Fantasy, Action, Supernatural</p>
                        </div>
                    </div>
                    <button class="trailerButton" value="videos/heaven_feel.mp4"> Preview </button>
                </td>

                <!-- STUDIO -->
                <td class="studio">
                    <a class="studio_links" href="https://vi.wikipedia.org/wiki/Ufotable">
                        <img class="studio_image" src="images/studios/ufotable.jpg">
                    </a>
                </td>
            </tr>
            
            <tr>
                <td class="rank">6</td>

                <!-- ANIME -->
                <td class="item">
                    <a class="anime_links" href="https://animevietsub.pub/phim/fate-zero-i2-a875/" target="_blank">
                        <img class="image" src="images/anims/fate_zero.jpg">
                    </a>
                    <div class="descriptions">
                        <div class="detail">
                            <a class="anime_links" href="https://animevietsub.pub/phim/fate-zero-i2-a875/" target="_blank">
                                <h3>Fate/Zero</h3>
                            </a>
                            <p>- TV Series (25 episodes)                </p>
                            <p>- Rating: 8.54                           </p>
                            <p>- Thể loại: Fantasy, Action, Supernatural</p>
                        </div>
                    </div>
                    <button class="trailerButton" value="videos/fate_zero.mp4"> Preview </button>
                </td>

                <!-- STUDIO -->
                <td class="studio">
                    <a class="studio_links" href="https://vi.wikipedia.org/wiki/Ufotable">
                        <img class="studio_image" src="images/studios/ufotable.jpg">
                    </a>
                </td>
            </tr>
        
        </table>

    </div>

    <!-- SEARCHING BAR SCRIPT -->
    <script>
        let debug = document.getElementById('debug');

        function isNum(str) {
            return (!isNaN(str) && str.length != 0);
        }

        function findAnime() {
            var inp = document.getElementById("inp").value.toUpperCase();
            var tr = document.getElementsByTagName("tr");
            var cnt = 1, tagname = (isNum(inp) ? "td" : "h3");
            for (var i = 1; i < tr.length; i++) {
                var td = tr[i].getElementsByTagName(tagname)[0];

                var color = (cnt % 2 ? "rgb(60, 60, 60)" : "rgb(40, 40, 40)");
                tr[i].style.backgroundColor = color;
                if (td.innerHTML.toUpperCase().indexOf(inp) != -1) {
                    tr[i].style.display = "";
                    cnt++;
                } else {
                    tr[i].style.display = "none";
                }
            }
        }

        function closeOverlay() {
            document.getElementById('overlay').style.display = "none";
            document.getElementById('iframeContainer').style.display = 'none';
            document.getElementById('video').src = '';
        }

        var button = document.getElementsByClassName('trailerButton');
        for (let i = 0; i < button.length; i++) {
            let x = button[i];
            x.addEventListener('click', function() {
                document.getElementById('overlay').style.display = "block";
                document.getElementById('iframeContainer').style.display = "block";
                video.src = x.value;
            });
        }
    </script>

    <!-- ADVANCED SEARCH SCRIPT -->
    <script>
        function advance() {
            document.getElementById("advanceSearchContainer").style.display = "block";
        }
        function closeTab() {
            let tab = document.getElementById("advanceSearchContainer")
            tab.style.display = "none";
            document.getElementById("advanceSearch").reset();
        }
        function submitForm() {
            let debug = document.getElementById("debug");
            let checkValues = document.getElementsByName("genre");
            let values = [];
            for (let i = 0; i < checkValues.length; i++) {
                if (checkValues[i].checked) {
                    let genreChecked = checkValues[i].id;
                    values.push(genreChecked.toUpperCase());
                }
            }   
            let tr = document.getElementsByTagName('tr');
            let result = [];
            for (let i = 1; i < tr.length; i++) {
                let genreList = tr[i].getElementsByTagName('p')[2].innerHTML;
                genreList = genreList.split("Thể loại:")[1].split(", ");
                let ok = (values.length == 0 ? 1 : 0);
                for (let j = 0; j < genreList.length; j++) {
                    genreList[j] = genreList[j].trim().toUpperCase();
                    for (let k = 0; k < values.length; k++) {
                        // debug.innerHTML += values[k] + ' ' + genreList[j] + "<br>";
                        if (values[k] == genreList[j]) {
                            ok = 1;
                            break;
                        }
                    }
                    if (ok) break;
                }
                if (ok) result.push(i);
            }
            let i = 1, j = 0, cnt = 1;
            while (i < tr.length) {
                var color = (cnt % 2 ? "rgb(60, 60, 60)" : "rgb(40, 40, 40)");
                if (i == result[j]) {
                    tr[i].style.display = "";
                    tr[i].style.backgroundColor = color;
                    cnt++;
                    j++;
                } else {
                    tr[i].style.display = "none";
                }
                i++;
            }
            // debug.innerHTML = result;
            document.getElementById("advanceSearchContainer").style.display = "none";
            document.getElementById("advanceSearch").reset();
        }

    </script>

</body>
</html>